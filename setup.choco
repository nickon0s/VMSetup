# Box Starter Options
$Boxstarter.RebootOk=$false 
$Boxstarter.NoPassword=$false
$Boxstarter.AutoLogin=$false
Update-ExecutionPolicy Bypass
refreshenv


# Defender
Write-Host "Disabling Defender YOLO..."
Set-MpPreference -DisableRealtimeMonitoring $true
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
Set-MpPreference -MAPSReporting Disabled
Set-MpPreference -SubmitSamplesConsent NeverSend


# Disable Telemetry
Write-Host "Disabling Telemetry..."
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" -Name "AllowTelemetry" -Type DWord -Value 0
Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection" -Name "AllowTelemetry" -Type DWord -Value 0
Set-ItemProperty -Path "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\DataCollection" -Name "AllowTelemetry" -Type DWord -Value 0
Disable-ScheduledTask -TaskName "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" | Out-Null
Disable-ScheduledTask -TaskName "Microsoft\Windows\Application Experience\ProgramDataUpdater" | Out-Null
Disable-ScheduledTask -TaskName "Microsoft\Windows\Autochk\Proxy" | Out-Null
Disable-ScheduledTask -TaskName "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" | Out-Null
Disable-ScheduledTask -TaskName "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" | Out-Null
Disable-ScheduledTask -TaskName "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" | Out-Null

<#
# Choco Packages
Write-Host "Installing all the Choco..."
choco feature enable -n allowGlobalConfirmation
choco install 7zip -r --no-progress
choco install git -r --no-progress
choco install googlechrome --ignore-checksums -r --no-progress
choco install firefox -r --no-progress
choco install heidisql --version=10.2.0.559900 -r --no-progress
choco install openjdk11 -r --no-progress
choco install putty -r --no-progress
choco install sysinternals --params "/InstallDir:C:\tools\sysinternals" -r --no-progress
#choco install vscode -r --no-progress
#choco install visualstudio2019community -r --no-progress
choco install burp-suite-free-edition -r --no-progress
choco install hxd -r --no-progress
choco install mingw -r --no-progress
choco install python3 -r --no-progress
choco install python2 -r --no-progress
choco install notepadplusplus -r --no-progress
choco install wsl-ubuntu-2004 -r --no-progress
choco install openvpn -r --no-progress
choco install openconnect-gui -r --no-progress
choco install wireshark -r --no-progress
choco install proxifier -r --no-progress


# GitHub
Write-Host "Cloning some gits..."
git clone https://github.com/dnSpy/dnSpy.git C:\tools\dnSpy
git clone https://github.com/BloodHoundAD/SharpHound3.git C:\tools\SharpHound3
git clone https://github.com/dafthack/MailSniper.git C:\tools\MailSniper
git clone https://github.com/decoder-it/juicy-potato.git C:\tools\juicy-potato
git clone https://github.com/djhohnstein/SharpChrome.git C:\tools\SharpChrome
git clone https://github.com/FortyNorthSecurity/Egress-Assess.git C:\tools\Egress-Assess
git clone https://github.com/FSecureLABS/SharpGPOAbuse.git C:\tools\SharpGPOAbuse
git clone https://github.com/gentilkiwi/mimikatz.git C:\tools\mimikatz
git clone https://github.com/GhostPack/Seatbelt.git C:\tools\Seatbelt
git clone https://github.com/HarmJ0y/DAMP.git C:\tools\DAMP
git clone https://github.com/hfiref0x/UACME.git C:\tools\UACME
git clone https://github.com/leechristensen/SpoolSample.git C:\tools\SpoolSample
git clone https://github.com/NetSPI/PowerUpSQL.git C:\tools\PowerUpSQL
git clone https://github.com/p3nt4/PowerShdll.git C:\tools\PowerShdll
git clone https://github.com/PowerShellMafia/PowerSploit.git C:\tools\PowerSploit
git clone https://github.com/rasta-mouse/MiscTools.git C:\tools\MiscTools
git clone https://github.com/rasta-mouse/Sherlock.git C:\tools\Sherlock
git clone https://github.com/rasta-mouse/Watson.git C:\tools\Watson
git clone https://github.com/tevora-threat/SharpView.git C:\tools\SharpView
git clone https://github.com/TheWover/donut.git C:\tools\donut
git clone https://github.com/ZeroPointSecurity/PhishingTemplates.git C:\tools\PhishingTemplates
git clone https://github.com/BloodHoundAD/BloodHound.git C:\tools\BloodHound
git clone https://github.com/mkaring/ConfuserEx.git C:\tools\ConfuserEx
git clone https://github.com/TheWover/donut.git C:\tools\donut
git clone https://github.com/Ne0nd0g/go-shellcode.git C:\tools\go-shellcode
git clone https://github.com/p3nt4/PowerShdll.git C:\tools\PowerShdll
git clone https://github.com/Mr-Un1k0d3r/RedTeamCCode.git C:\tools\RedTeamCCode
git clone https://github.com/GhostPack/Rubeus.git C:\tools\Rubeus
git clone https://github.com/optiv/ScareCrow C:\tools\ScareCrow
git clone https://github.com/shantanu561993/SharpChisel.git C:\tools\SharpChisel
git clone https://github.com/jpillora/chisel C:\tools\Chisel
git clone https://github.com/yashmundra/Shellcode-Encryption.git C:\tools\Shellcode-Encryption
git clone https://github.com/knownsec/shellcodeloader.git C:\tools\ShellcodeLoader
git clone https://github.com/djhohnstein/CSharpSetThreadContext.git C:\tools\CSharpShellcode
#>
refreshenv

# IE first run
Write-Host "Doing some IE BS"
New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer"
New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main"
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main" -Name DisableFirstRunCustomize -Value 1
refreshenv

# Neo4j
$neo4j = Test-Path -Path "C:\tools\Neo4j"
if (!$neo4j){
            Write-Host "Downloading and unzipping Neo4j..."
            Invoke-WebRequest -Uri 'https://neo4j.com/artifact.php?name=neo4j-community-4.0.0-windows.zip' -OutFile "C:\tools\neo4j.zip"
            Expand-Archive -Path "C:\tools\neo4j.zip" -DestinationPath "C:\tools\Neo4j"
            Remove-Item "C:\tools\neo4j.zip"
            }




## Misc
Remove-Item -Path "C:\Users\User\Desktop\*"

# UI
Set-WindowsExplorerOptions -EnableShowFileExtensions -EnableShowFullPathInTitleBar -EnableExpandToOpenFolder -EnableShowRibbon

# Hide Recycle Bin
reg add HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel /v "{645FF040-5081-101B-9F08-00AA002F954E}" /d 1

#Hide Taskbar Search Box
Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" -Name "SearchboxTaskbarMode" -Type DWord -Value 0

# Hide Task View button
Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowTaskViewButton" -Type DWord -Value 0

# Show small icons in taskbar
Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "TaskbarSmallIcons" -Type DWord -Value 1

# Unpin all Taskbar icons
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband" -Name "Favorites" -Type Binary -Value ([byte[]](0xFF))
Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband" -Name "FavoritesResolve" -ErrorAction SilentlyContinue


Rename-Computer -NewName RedHost
Restart-Computer
